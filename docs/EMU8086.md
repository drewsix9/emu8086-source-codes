# EMU8086.INC - Assembly Macro Library Reference

## Overview

The [`emu8086.inc`](c:\emu8086\inc\emu8086.inc) file is a comprehensive macro definitions library for the EMU8086 emulator that provides easy-to-use input/output functions for 8086 assembly programming. This library simplifies common operations like printing text, reading numbers, manipulating the cursor, and clearing the screen.

## Table of Contents

- [Installation](#installation)
- [Quick Reference](#quick-reference)
- [Usage](#usage)
- [Simple Macros](#simple-macros)
- [Procedure Macros](#procedure-macros)
- [Examples](#examples)
- [Important Notes](#important-notes)

## Quick Reference

| Macro           | Type      | Description                   | Documentation                                             |
| --------------- | --------- | ----------------------------- | --------------------------------------------------------- |
| `PUTC`          | Simple    | Print single character        | [→ Details](#putc---print-single-character)               |
| `PRINT`         | Simple    | Print string (no newline)     | [→ Details](#print---print-string-no-newline)             |
| `PRINTN`        | Simple    | Print string (with newline)   | [→ Details](#printn---print-string-with-newline)          |
| `CURSOROFF`     | Simple    | Hide cursor                   | [→ Details](#cursoroff---hide-cursor)                     |
| `CURSORON`      | Simple    | Show cursor                   | [→ Details](#cursoron---show-cursor)                      |
| `GOTOXY`        | Simple    | Set cursor position           | [→ Details](#gotoxy---set-cursor-position)                |
| `SCAN_NUM`      | Procedure | Read signed number to CX      | [→ Details](#scan_num---read-signed-number)               |
| `PRINT_STRING`  | Procedure | Print null-terminated string  | [→ Details](#print_string---print-null-terminated-string) |
| `PTHIS`         | Procedure | Print inline string           | [→ Details](#pthis---print-inline-string)                 |
| `GET_STRING`    | Procedure | Read string input             | [→ Details](#get_string---read-string-input)              |
| `CLEAR_SCREEN`  | Procedure | Clear display                 | [→ Details](#clear_screen---clear-display)                |
| `PRINT_NUM`     | Procedure | Print signed number from AX   | [→ Details](#print_num---print-signed-number)             |
| `PRINT_NUM_UNS` | Procedure | Print unsigned number from AX | [→ Details](#print_num_uns---print-unsigned-number)       |

**Note:** Procedure macros require corresponding `DEFINE_...` declarations in your code.

## Installation

Include the library in your assembly program:

```assembly
INCLUDE 'emu8086.inc'
```

## Usage

The library contains two types of macros:

1. **Simple Macros** - Can be used directly
2. **Procedure Macros** - Require corresponding `DEFINE_...` declarations

### Procedure Declaration Rules

For procedure macros, you must include the corresponding `DEFINE_...` macro **once** in your program:

- Place definitions at the **end** of your file, before the `END` directive
- For COM files: after `ORG 100h` directive
- For EXE files: inside the code segment

## Simple Macros

### PUTC - Print Single Character

**[→ Source Code](emu8086.inc#L37-L43)**

```assembly
PUTC char
```

Prints a character and advances cursor position.

**Example:**

```assembly
PUTC 'A'        ; Prints letter A
PUTC 13         ; Carriage return
PUTC 10         ; Line feed
```

### PRINT - Print String (No Newline)

**[→ Source Code](emu8086.inc#L46-L68)**

```assembly
PRINT 'string'
```

Prints a string without adding a newline.

**Example:**

```assembly
PRINT 'Hello World!'
```

### PRINTN - Print String (With Newline)

**[→ Source Code](emu8086.inc#L71-L93)**

```assembly
PRINTN 'string'
```

Prints a string and automatically adds a newline.

**Example:**

```assembly
PRINTN 'Hello World!'
```

### CURSOROFF - Hide Cursor

**[→ Source Code](emu8086.inc#L96-L106)**

```assembly
CURSOROFF
```

Makes the cursor invisible.

### CURSORON - Show Cursor

**[→ Source Code](emu8086.inc#L110-L120)**

```assembly
CURSORON
```

Makes the cursor visible.

### GOTOXY - Set Cursor Position

**[→ Source Code](emu8086.inc#L123-L135)**

```assembly
GOTOXY col, row
```

Moves cursor to specified column and row (0-based).

**Example:**

```assembly
GOTOXY 10, 5    ; Move to column 10, row 5
```

## Procedure Macros

### SCAN_NUM - Read Signed Number

**Definition Required:** `DEFINE_SCAN_NUM`  
**[→ Source Code](emu8086.inc#L142-L259)**

```assembly
CALL SCAN_NUM
```

Reads a multi-digit signed number from keyboard and stores result in CX register.

**Features:**

- Supports negative numbers (minus sign)
- Handles backspace for corrections
- Validates input (digits only)
- 16-bit range: -32768 to 32767

### PRINT_STRING - Print Null-Terminated String

**Definition Required:** `DEFINE_PRINT_STRING`  
**[→ Source Code](emu8086.inc#L265-L286)**

```assembly
LEA SI, string_address
CALL PRINT_STRING
```

Prints a null-terminated string at current cursor position.

**Example:**

```assembly
msg DB 'Hello World!', 0
LEA SI, msg
CALL PRINT_STRING
```

### PTHIS - Print Inline String

**Definition Required:** `DEFINE_PTHIS`  
**[→ Source Code](emu8086.inc#L293-L337)**

```assembly
CALL PTHIS
DB 'string', 0
```

Prints a string defined immediately after the CALL instruction.

### GET_STRING - Read String Input

**Definition Required:** `DEFINE_GET_STRING`  
**[→ Source Code](emu8086.inc#L344-L409)**

```assembly
LEA DI, buffer
MOV DX, buffer_size
CALL GET_STRING
```

Reads a string from user into specified buffer.

**Parameters:**

- DI: pointer to buffer
- DX: buffer size

### CLEAR_SCREEN - Clear Display

**Definition Required:** `DEFINE_CLEAR_SCREEN`  
**[→ Source Code](emu8086.inc#L416-L457)**

```assembly
CALL CLEAR_SCREEN
```

Clears the entire screen and positions cursor at top-left.

### PRINT_NUM - Print Signed Number

**Definition Required:** `DEFINE_PRINT_NUM` and `DEFINE_PRINT_NUM_UNS`  
**[→ Source Code](emu8086.inc#L466-L492)**

```assembly
MOV AX, number
CALL PRINT_NUM
```

Prints a signed 16-bit number from AX register.

### PRINT_NUM_UNS - Print Unsigned Number

**Definition Required:** `DEFINE_PRINT_NUM_UNS`  
**[→ Source Code](emu8086.inc#L499-L562)**

```assembly
MOV AX, number
CALL PRINT_NUM_UNS
```

Prints an unsigned 16-bit number (0-65535) from AX register.

## Examples

### Complete Program Example

```assembly
INCLUDE 'emu8086.inc'

ORG 100h

; Clear screen and show welcome message
CALL CLEAR_SCREEN
PRINTN 'Number Input/Output Demo'
PRINTN '========================'

; Get number from user
PRINT 'Enter a number: '
CALL SCAN_NUM

; Display the number
PRINTN ''
PRINT 'You entered: '
MOV AX, CX
CALL PRINT_NUM

; Wait for key and exit
PRINTN ''
PRINTN 'Press any key to exit...'
MOV AH, 0
INT 16h

RET

; Define required procedures
DEFINE_CLEAR_SCREEN
DEFINE_SCAN_NUM
DEFINE_PRINT_NUM
DEFINE_PRINT_NUM_UNS

END
```

### String Handling Example

```assembly
INCLUDE 'emu8086.inc'

ORG 100h

; Using PTHIS for inline strings
CALL PTHIS
DB 'Enter your name: ', 0

; Get string input
LEA DI, name_buffer
MOV DX, 50
CALL GET_STRING

; Display greeting
PRINTN ''
CALL PTHIS
DB 'Hello, ', 0

LEA SI, name_buffer
CALL PRINT_STRING

PRINTN '!'

RET

name_buffer DB 50 DUP(?)

; Define required procedures
DEFINE_PTHIS
DEFINE_GET_STRING
DEFINE_PRINT_STRING

END
```

## Important Notes

### Memory Considerations

- Only declare procedures you actually use to reduce compilation time
- Procedure definitions can be placed at the beginning after `ORG 100h` or at the end before `END`

### Register Usage

- [`SCAN_NUM`](c:\emu8086\inc\emu8086.inc) returns result in CX register
- [`PRINT_NUM`](c:\emu8086\inc\emu8086.inc) and [`PRINT_NUM_UNS`](c:\emu8086\inc\emu8086.inc) expect input in AX register
- Most macros preserve registers automatically

### Input Validation

- [`SCAN_NUM`](c:\emu8086\inc\emu8086.inc) validates numeric input and handles errors gracefully
- [`GET_STRING`](c:\emu8086\inc\emu8086.inc) handles buffer overflow protection

### Screen Coordinates

- [`GOTOXY`](c:\emu8086\inc\emu8086.inc) uses 0-based coordinates (0,0 = top-left corner)
- Standard text mode is typically 80x25 characters

## Dependencies

This library uses standard BIOS interrupts:

- INT 10h: Video services
- INT 16h: Keyboard services

Compatible with EMU8086 emulator and real 8086/8088 processors.
